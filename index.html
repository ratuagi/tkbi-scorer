<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="TKBI Green Finance Scorer for Indonesian SMEs - Assess your business alignment with Indonesian Taxonomy for Sustainable Finance">
    <title>TKBI Green Finance Scorer for SMEs</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸŒ±</text></svg>">
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        .hover-scale {
            transition: transform 0.2s;
        }
        .hover-scale:hover {
            transform: scale(1.02);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div id="app"></div>

    <script>
        // ==================== STATE MANAGEMENT ====================
        let state = {
            step: 'intro',
            smeData: { companyName: '', industry: '', employees: '', revenue: '' },
            selectedEO: '',
            eoAnswers: {},
            dnshAnswers: {},
            socialAnswers: {},
            results: null
        };

        // ==================== DATA ====================
        const environmentalObjectives = {
            EO1: {
                name: 'Climate Change Mitigation',
                description: 'Reduce greenhouse gas emissions and climate change impacts',
                icon: 'ğŸŒ',
                questions: [
                    { id: 'eo1_q1', text: 'Does your business reduce greenhouse gas emissions?', weight: 25 },
                    { id: 'eo1_q2', text: 'Do you use renewable energy sources (solar, wind, etc.)?', weight: 20 },
                    { id: 'eo1_q3', text: 'Do you have energy efficiency programs?', weight: 20 },
                    { id: 'eo1_q4', text: 'Do you track your company\'s carbon footprint?', weight: 20 },
                    { id: 'eo1_q5', text: 'Do you have emission reduction targets?', weight: 15 }
                ]
            },
            EO2: {
                name: 'Climate Change Adaptation',
                description: 'Increase resilience to climate change impacts',
                icon: 'ğŸŒ¦ï¸',
                questions: [
                    { id: 'eo2_q1', text: 'Do you assess climate risks to your business?', weight: 25 },
                    { id: 'eo2_q2', text: 'Do you have adaptation plans for extreme weather?', weight: 25 },
                    { id: 'eo2_q3', text: 'Are your facilities resilient to floods/droughts?', weight: 25 },
                    { id: 'eo2_q4', text: 'Do you have water conservation systems?', weight: 25 }
                ]
            },
            EO3: {
                name: 'Protection of Healthy Ecosystems & Biodiversity',
                description: 'Protect nature and biodiversity',
                icon: 'ğŸŒ¿',
                questions: [
                    { id: 'eo3_q1', text: 'Do your operations avoid damaging natural habitats?', weight: 30 },
                    { id: 'eo3_q2', text: 'Do you have measures to protect biodiversity?', weight: 25 },
                    { id: 'eo3_q3', text: 'Do you avoid deforestation or land degradation?', weight: 25 },
                    { id: 'eo3_q4', text: 'Do you use sustainable raw materials?', weight: 20 }
                ]
            },
            EO4: {
                name: 'Resource Resilience & Circular Economy',
                description: 'Efficient resource use and circular economy principles',
                icon: 'â™»ï¸',
                questions: [
                    { id: 'eo4_q1', text: 'Do you have waste reduction programs?', weight: 25 },
                    { id: 'eo4_q2', text: 'Do you recycle or reuse materials?', weight: 25 },
                    { id: 'eo4_q3', text: 'Do you apply circular economy principles?', weight: 25 },
                    { id: 'eo4_q4', text: 'Do you use sustainable packaging?', weight: 25 }
                ]
            }
        };

        const dnshQuestions = [
            { id: 'dnsh1', text: 'Do your activities NOT significantly harm other environmental objectives?', icon: 'âš ï¸' },
            { id: 'dnsh2', text: 'Do you have proper waste management systems?', icon: 'ğŸ—‘ï¸' },
            { id: 'dnsh3', text: 'Do you comply with Indonesian environmental regulations?', icon: 'ğŸ“‹' }
        ];

        const socialQuestions = [
            { id: 'social1', text: 'Do you comply with workplace safety standards?', icon: 'ğŸ¦º' },
            { id: 'social2', text: 'Do you pay fair wages according to minimum wage regulations?', icon: 'ğŸ’°' },
            { id: 'social3', text: 'Do you NOT employ child labor?', icon: 'ğŸ‘¶' },
            { id: 'social4', text: 'Do you have gender equality policies?', icon: 'âš–ï¸' }
        ];

        // ==================== CALCULATION FUNCTIONS ====================
        function calculateEOScore(answers, questions) {
            let totalWeight = 0, earnedWeight = 0;
            questions.forEach(q => {
                totalWeight += q.weight;
                if (answers[q.id] === 'yes') earnedWeight += q.weight;
            });
            return Math.round((earnedWeight / totalWeight) * 100);
        }

        function checkPass(answers) {
            return Object.values(answers).every(a => a === 'yes');
        }

        function calculateFinalClassification() {
            const eoScore = calculateEOScore(state.eoAnswers, environmentalObjectives[state.selectedEO].questions);
            const dnshPass = checkPass(state.dnshAnswers);
            const socialPass = checkPass(state.socialAnswers);

            let classification, color, bgColor, recommendations;

            if (eoScore >= 80 && dnshPass && socialPass) {
                classification = 'GREEN';
                color = 'text-green-600';
                bgColor = 'bg-green-50';
                recommendations = [
                    'ğŸ‰ Congratulations! Your business meets TKBI standards for Green classification',
                    'ğŸ’° You qualify for green financing with preferential interest rates',
                    'ğŸ“ˆ Maintain your sustainable practices and continue to improve',
                    'ğŸ“„ Document your achievements for bank applications',
                    'ğŸŒŸ Consider becoming a sustainability leader in your industry'
                ];
            } else if (eoScore >= 60 || (eoScore >= 50 && (dnshPass || socialPass))) {
                classification = 'TRANSITION';
                color = 'text-yellow-600';
                bgColor = 'bg-yellow-50';
                recommendations = [
                    'ğŸ“Š Your business is in transition toward sustainability',
                    'ğŸ¯ Focus on improving areas with low scores',
                    !dnshPass ? 'âš ï¸ Improve DNSH (Do No Significant Harm) practices' : '',
                    !socialPass ? 'ğŸ‘¥ Enhance social aspects: workplace safety, fair wages, equality' : '',
                    'ğŸ’¼ You can still access some sustainable financing programs',
                    'ğŸ“… Target to achieve 80+ score within 12-24 months',
                    'ğŸ¤ Consider partnering with sustainability consultants'
                ].filter(r => r);
            } else {
                classification = 'DOES NOT MEET CLASSIFICATION';
                color = 'text-red-600';
                bgColor = 'bg-red-50';
                recommendations = [
                    'ğŸ“Œ Your business does not yet meet TKBI standards',
                    'ğŸ”§ Start with simple steps: energy efficiency, waste reduction',
                    'ğŸ‘¨â€ğŸ’¼ Consult with sustainability experts for an improvement roadmap',
                    'ğŸ’¡ Investment in sustainable practices will unlock financing access',
                    'ğŸ“‹ Focus on environmental regulation compliance first',
                    'ğŸ“š Access free resources and training on sustainable practices',
                    'ğŸŒ± Every journey starts with a first step - begin today!'
                ];
            }

            state.results = {
                classification, color, bgColor, eoScore, dnshPass, socialPass, recommendations,
                selectedEO: environmentalObjectives[state.selectedEO].name,
                selectedEOIcon: environmentalObjectives[state.selectedEO].icon
            };
            state.step = 'results';
            render();
        }

        function generateReport() {
            const r = state.results;
            const content = `
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘        TKBI ASSESSMENT REPORT - GREEN FINANCE SCORING         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

COMPANY INFORMATION:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  Company Name    : ${state.smeData.companyName}
  Industry        : ${state.smeData.industry}
  Employees       : ${state.smeData.employees}
  Annual Revenue  : ${state.smeData.revenue}

PRIMARY ENVIRONMENTAL OBJECTIVE:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  ${r.selectedEOIcon} ${r.selectedEO}

ASSESSMENT RESULTS:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  Final Classification     : ${r.classification}
  EO Score                 : ${r.eoScore}/100
  DNSH Check               : ${r.dnshPass ? 'âœ“ PASS' : 'âœ— FAIL'}
  Social Aspects           : ${r.socialPass ? 'âœ“ PASS' : 'âœ— FAIL'}

RECOMMENDATIONS:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
${r.recommendations.map((rec, i) => `  ${i + 1}. ${rec.replace(/[ğŸ‰ğŸ’°ğŸ“ˆğŸ“„ğŸŒŸğŸ“ŠğŸ¯âš ï¸ğŸ‘¥ğŸ’¼ğŸ“…ğŸ¤ğŸ“ŒğŸ”§ğŸ‘¨â€ğŸ’¼ğŸ’¡ğŸ“‹ğŸ“šğŸŒ±]/g, '')}`).join('\n')}

NEXT STEPS:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  â–¡ Review recommendations with your management team
  â–¡ Develop an action plan for improvement areas
  â–¡ Contact banks for green financing options
  â–¡ Set quarterly sustainability goals
  â–¡ Schedule follow-up assessment in 6 months

Assessment Date: ${new Date().toLocaleDateString('en-US', { 
    weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' 
})}

Generated by: TKBI Green Finance Scorer
Disclaimer: For Academic Purposes KB-KAIST ASEAN Young Leaders Micro Degree Program 2025 based on Indonesian Taxonomy for Sustainable Finance (TKBI)
Framework: Sector Agnostic Decision Tree (SDT)

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  This report can be submitted to Indonesian financial         â•‘
â•‘  institutions for green financing applications.               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            `.trim();

            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `TKBI_Report_${state.smeData.companyName.replace(/\s/g, '_')}_${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // ==================== RENDER FUNCTIONS ====================
        function renderIntro() {
            return `
                <div class="max-w-5xl mx-auto p-4 md:p-8 fade-in">
                    <!-- Header -->
                    <div class="bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-2xl shadow-2xl p-8 mb-8">
                        <div class="text-center">
                            <div class="text-6xl mb-4">ğŸŒ±</div>
                            <h1 class="text-4xl md:text-5xl font-bold mb-3">
                                TKBI Green Finance Scorer
                            </h1>
                            <p class="text-xl md:text-2xl text-green-50 mb-2">for Indonesian SMEs</p>
                            <div class="inline-block bg-white/20 backdrop-blur-sm rounded-full px-6 py-2 mt-2">
                                <p class="text-sm font-medium">Indonesian Taxonomy for Sustainable Finance - SDT Assessment</p>
                            </div>
                        </div>
                    </div>

                    <!-- About -->
                    <div class="bg-white rounded-xl shadow-lg p-8 mb-6 hover-scale">
                        <h2 class="text-2xl font-bold mb-4 text-gray-800 flex items-center">
                            <span class="text-3xl mr-3">â„¹ï¸</span> About This Assessment
                        </h2>
                        <p class="text-gray-700 leading-relaxed mb-4">
                            This tool helps <strong>Small and Medium Enterprises (SMEs)</strong> assess their alignment with the 
                            <strong>Indonesian Taxonomy for Sustainable Finance (TKBI)</strong> using the 
                            <strong>Sector Agnostic Decision Tree (SDT)</strong> approach.
                        </p>
                        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg mb-4">
                            <p class="text-sm text-blue-900 font-medium">
                                ğŸ“Š The assessment evaluates your business across 4 Environmental Objectives, 
                                Do No Significant Harm (DNSH) criteria, and Social Aspects.
                            </p>
                        </div>
                        <p class="text-gray-700 mb-4"><strong>Your business will be classified as:</strong></p>
                        <div class="grid md:grid-cols-3 gap-4">
                            <div class="bg-green-50 border-2 border-green-500 rounded-lg p-4">
                                <div class="text-3xl mb-2">âœ“</div>
                                <h3 class="font-bold text-green-700 mb-1">GREEN</h3>
                                <p class="text-sm text-gray-600">Meets standards for green financing with preferential rates</p>
                            </div>
                            <div class="bg-yellow-50 border-2 border-yellow-500 rounded-lg p-4">
                                <div class="text-3xl mb-2">âš </div>
                                <h3 class="font-bold text-yellow-700 mb-1">TRANSITION</h3>
                                <p class="text-sm text-gray-600">On the journey toward sustainability</p>
                            </div>
                            <div class="bg-red-50 border-2 border-red-500 rounded-lg p-4">
                                <div class="text-3xl mb-2">âœ—</div>
                                <h3 class="font-bold text-red-700 mb-1">DOES NOT MEET</h3>
                                <p class="text-sm text-gray-600">Needs improvement for green finance access</p>
                            </div>
                        </div>
                        <div class="mt-4 flex items-center text-sm text-gray-600">
                            <span class="mr-2">â±ï¸</span>
                            <span>Completion time: <strong>15-20 minutes</strong></span>
                        </div>
                    </div>

                    <!-- Form -->
                    <div class="bg-white rounded-xl shadow-lg p-8">
                        <h2 class="text-2xl font-bold mb-6 text-gray-800 flex items-center">
                            <span class="text-3xl mr-3">ğŸ¢</span> Company Information
                        </h2>
                        <div class="space-y-5">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Company Name *</label>
                                <input type="text" id="companyName" 
                                    class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-green-500 focus:ring focus:ring-green-200 transition" 
                                    placeholder="PT. Green Business Indonesia" value="${state.smeData.companyName}">
                            </div>
                            <div class="grid md:grid-cols-2 gap-5">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Industry/Sector *</label>
                                    <select id="industry" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-green-500 focus:ring focus:ring-green-200 transition">
                                        <option value="">Select industry...</option>
                                        <option value="Agriculture">ğŸŒ¾ Agriculture & Plantation</option>
                                        <option value="Manufacturing">ğŸ­ Manufacturing</option>
                                        <option value="Trade">ğŸ›’ Trade & Commerce</option>
                                        <option value="Services">ğŸ’¼ Services</option>
                                        <option value="Construction">ğŸ—ï¸ Construction</option>
                                        <option value="Transportation">ğŸšš Transportation & Logistics</option>
                                        <option value="Technology">ğŸ’» Technology & Digital</option>
                                        <option value="Other">ğŸ“‹ Other</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Number of Employees *</label>
                                    <select id="employees" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-green-500 focus:ring focus:ring-green-200 transition">
                                        <option value="">Select...</option>
                                        <option value="1-5">1-5 people (Micro)</option>
                                        <option value="6-19">6-19 people (Small)</option>
                                        <option value="20-99">20-99 people (Medium)</option>
                                        <option value="100+">100+ people</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Annual Revenue *</label>
                                <select id="revenue" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-green-500 focus:ring focus:ring-green-200 transition">
                                    <option value="">Select...</option>
                                    <option value="< 300M IDR">Less than IDR 300 million</option>
                                    <option value="300M - 2.5B IDR">IDR 300 million - 2.5 billion</option>
                                    <option value="2.5 - 50B IDR">IDR 2.5 - 50 billion</option>
                                    <option value="> 50B IDR">More than IDR 50 billion</option>
                                </select>
                            </div>
                        </div>
                        <button onclick="startAssessment()" 
                            class="mt-8 w-full bg-gradient-to-r from-green-600 to-emerald-600 text-white py-4 rounded-lg font-bold text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition duration-200">
                            ğŸš€ Start Assessment
                        </button>
                    </div>

                    <!-- Footer -->
                    <div class="mt-8 text-center text-sm text-gray-500">
                        <p>Based on Indonesian Taxonomy for Sustainable Finance (TKBI) â€¢ OJK Framework</p>
                    </div>
                </div>
            `;
        }

        function renderEOSelection() {
            return `
                <div class="max-w-5xl mx-auto p-4 md:p-8 fade-in">
                    <div class="bg-white rounded-xl shadow-lg p-8 mb-6">
                        <div class="flex items-center mb-2">
                            <span class="bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-bold mr-3">Step 1 of 4</span>
                        </div>
                        <h2 class="text-3xl font-bold mb-3 text-gray-800">Select Primary Environmental Objective</h2>
                        <p class="text-gray-600">
                            Choose the Environmental Objective (EO) that best aligns with your business's main contribution to sustainability.
                        </p>
                    </div>
                    <div class="grid md:grid-cols-2 gap-6">
                        ${Object.entries(environmentalObjectives).map(([key, eo]) => `
                            <div onclick="selectEO('${key}')" 
                                class="bg-white rounded-xl shadow-lg p-6 cursor-pointer border-2 border-transparent hover:border-green-500 hover:shadow-xl transform hover:-translate-y-1 transition duration-200">
                                <div class="flex items-start">
                                    <span class="text-5xl mr-4">${eo.icon}</span>
                                    <div>
                                        <h3 class="text-xl font-bold text-green-700 mb-2">${key}: ${eo.name}</h3>
                                        <p class="text-gray-600">${eo.description}</p>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderEOQuestions() {
            const eo = environmentalObjectives[state.selectedEO];
            const answered = Object.keys(state.eoAnswers).length;
            const total = eo.questions.length;
            const progress = (answered / total) * 100;

            return `
                <div class="max-w-4xl mx-auto p-4 md:p-8 fade-in">
                    <div class="bg-white rounded-xl shadow-lg p-8 mb-6">
                        <div class="flex items-center justify-between mb-4">
                            <span class="bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-bold">Step 2 of 4</span>
                            <span class="text-sm text-gray-600">${answered}/${total} answered</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2 mb-4">
                            <div class="bg-green-600 h-2 rounded-full transition-all duration-300" style="width: ${progress}%"></div>
                        </div>
                        <div class="flex items-center mb-2">
                            <span class="text-4xl mr-3">${eo.icon}</span>
                            <h2 class="text-2xl font-bold text-gray-800">${eo.name}</h2>
                        </div>
                        <p class="text-gray-600">${eo.description}</p>
                    </div>
                    <div class="space-y-4">
                        ${eo.questions.map((q, idx) => `
                            <div class="bg-white rounded-xl shadow-lg p-6 hover-scale">
                                <div class="flex items-start mb-4">
                                    <span class="bg-green-100 text-green-700 rounded-full w-8 h-8 flex items-center justify-center font-bold text-sm mr-3 flex-shrink-0">
                                        ${idx + 1}
                                    </span>
                                    <p class="font-semibold text-gray-800 flex-1">${q.text}</p>
                                </div>
                                <div class="flex gap-3">
                                    <button onclick="answerEOQuestion('${q.id}', 'yes')" 
                                        class="flex-1 py-3 px-6 rounded-lg font-bold transition ${
                                            state.eoAnswers[q.id] === 'yes' 
                                            ? 'bg-green-600 text-white shadow-lg' 
                                            : 'bg-gray-100 text-gray-700 hover:bg-green-50'
                                        }">
                                        âœ“ Yes
                                    </button>
                                    <button onclick="answerEOQuestion('${q.id}', 'no')" 
                                        class="flex-1 py-3 px-6 rounded-lg font-bold transition ${
                                            state.eoAnswers[q.id] === 'no' 
                                            ? 'bg-red-600 text-white shadow-lg' 
                                            : 'bg-gray-100 text-gray-700 hover:bg-red-50'
                                        }">
                                        âœ— No
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <button onclick="goToDNSH()" 
                        class="mt-6 w-full py-4 rounded-lg font-bold text-lg shadow-lg transition ${
                            answered === total
                            ? 'bg-green-600 text-white hover:bg-green-700'
                            : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                        }" ${answered !== total ? 'disabled' : ''}>
                        Continue to DNSH Check â†’
                    </button>
                </div>
            `;
        }

        function renderDNSH() {
            const answered = Object.keys(state.dnshAnswers).length;
            const total = dnshQuestions.length;
            const progress = (answered / total) * 100;

            return `
                <div class="max-w-4xl mx-auto p-4 md:p-8 fade-in">
                    <div class="bg-white rounded-xl shadow-lg p-8 mb-6">
                        <div class="flex items-center justify-between mb-4">
                            <span class="bg-orange-100 text-orange-700 px-3 py-1 rounded-full text-sm font-bold">Step 3 of 4</span>
                            <span class="text-sm text-gray-600">${answered}/${total} answered</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2 mb-4">
                            <div class="bg-orange-600 h-2 rounded-full transition-all duration-300" style="width: ${progress}%"></div>
                        </div>
                        <h2 class="text-2xl font-bold mb-2 text-gray-800">DNSH (Do No Significant Harm) Check</h2>
                        <p class="text-gray-600">Ensure your business activities do NOT significantly harm other environmental objectives.</p>
                    </div>
                    <div class="space-y-4">
                        ${dnshQuestions.map((q, idx) => `
                            <div class="bg-white rounded-xl shadow-lg p-6 hover-scale">
                                <div class="flex items-start mb-4">
                                    <span class="text-3xl mr-3">${q.icon}</span>
                                    <p class="font-semibold text-gray-800 flex-1">${q.text}</p>
                                </div>
                                <div class="flex gap-3">
                                    <button onclick="answerDNSH('${q.id}', 'yes')" 
                                        class="flex-1 py-3 px-6 rounded-lg font-bold transition ${
                                            state.dnshAnswers[q.id] === 'yes' 
                                            ? 'bg-green-600 text-white shadow-lg' 
                                            : 'bg-gray-100 text-gray-700 hover:bg-green-50'
                                        }">
                                        âœ“ Yes
                                    </button>
                                    <button onclick="answerDNSH('${q.id}', 'no')" 
                                        class="flex-1 py-3 px-6 rounded-lg font-bold transition ${
                                            state.dnshAnswers[q.id] === 'no' 
                                            ? 'bg-red-600 text-white shadow-lg' 
                                            : 'bg-gray-100 text-gray-700 hover:bg-red-50'
                                        }">
                                        âœ— No
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <button onclick="goToSocial()" 
                        class="mt-6 w-full py-4 rounded-lg font-bold text-lg shadow-lg transition ${
                            answered === total
                            ? 'bg-orange-600 text-white hover:bg-orange-700'
                            : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                        }" ${answered !== total ? 'disabled' : ''}>
                        Continue to Social Aspects â†’
                    </button>
                </div>
            `;
        }

        function renderSocial() {
            const answered = Object.keys(state.socialAnswers).length;
            const total = socialQuestions.length;
            const progress = (answered / total) * 100;

            return `
                <div class="max-w-4xl mx-auto p-4 md:p-8 fade-in">
                    <div class="bg-white rounded-xl shadow-lg p-8 mb-6">
                        <div class="flex items-center justify-between mb-4">
                            <span class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm font-bold">Step 4 of 4</span>
                            <span class="text-sm text-gray-600">${answered}/${total} answered</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2 mb-4">
                            <div class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: ${progress}%"></div>
                        </div>
                        <h2 class="text-2xl font-bold mb-2 text-gray-800">Social Aspects Assessment</h2>
                        <p class="text-gray-600">Assessment of social aspects including workplace safety, fair wages, and social responsibilities.</p>
                    </div>
                    <div class="space-y-4">
                        ${socialQuestions.map((q, idx) => `
                            <div class="bg-white rounded-xl shadow-lg p-6 hover-scale">
                                <div class="flex items-start mb-4">
                                    <span class="text-3xl mr-3">${q.icon}</span>
                                    <p class="font-semibold text-gray-800 flex-1">${q.text}</p>
                                </div>
                                <div class="flex gap-3">
                                    <button onclick="answerSocial('${q.id}', 'yes')" 
                                        class="flex-1 py-3 px-6 rounded-lg font-bold transition ${
                                            state.socialAnswers[q.id] === 'yes' 
                                            ? 'bg-green-600 text-white shadow-lg' 
                                            : 'bg-gray-100 text-gray-700 hover:bg-green-50'
                                        }">
                                        âœ“ Yes
                                    </button>
                                    <button onclick="answerSocial('${q.id}', 'no')" 
                                        class="flex-1 py-3 px-6 rounded-lg font-bold transition ${
                                            state.socialAnswers[q.id] === 'no' 
                                            ? 'bg-red-600 text-white shadow-lg' 
                                            : 'bg-gray-100 text-gray-700 hover:bg-red-50'
                                        }">
                                        âœ— No
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <button onclick="calculateFinalClassification()" 
                        class="mt-6 w-full py-4 rounded-lg font-bold text-lg shadow-lg transition ${
                            answered === total
                            ? 'bg-blue-600 text-white hover:bg-blue-700'
                            : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                        }" ${answered !== total ? 'disabled' : ''}>
                        ğŸ¯ View Assessment Results
                    </button>
                </div>
            `;
        }

        function renderResults() {
            const r = state.results;
            return `
                <div class="max-w-5xl mx-auto p-4 md:p-8 fade-in">
                    <!-- Results Header -->
                    <div class="bg-white rounded-xl shadow-lg p-8 mb-6">
                        <div class="text-center mb-6">
                            <h2 class="text-3xl font-bold mb-2 text-gray-800">ğŸ“Š TKBI Assessment Results</h2>
                            <div class="text-sm text-gray-600 space-y-1">
                                <p><strong>Company:</strong> ${state.smeData.companyName}</p>
                                <p><strong>Industry:</strong> ${state.smeData.industry}</p>
                                <p><strong>Date:</strong> ${new Date().toLocaleDateString('en-US', { 
                                    weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' 
                                })}</p>
                            </div>
                        </div>
                    </div>

                    <!-- Classification Result -->
                    <div class="${r.bgColor} border-4 ${r.color.replace('text-', 'border-')} rounded-xl shadow-2xl p-10 mb-6 text-center">
                        <h3 class="text-xl text-gray-700 mb-3 font-medium">Final Classification</h3>
                        <div class="${r.color} text-5xl md:text-6xl font-black mb-6">
                            ${r.classification}
                        </div>
                        <div class="text-8xl mb-4">
                            ${r.classification === 'GREEN' ? 'âœ…' : r.classification === 'TRANSITION' ? 'âš ï¸' : 'âŒ'}
                        </div>
                        <div class="inline-block bg-white/80 backdrop-blur-sm rounded-lg px-6 py-3">
                            <p class="text-sm font-semibold text-gray-700">
                                ${r.selectedEOIcon} Primary Focus: ${r.selectedEO}
                            </p>
                        </div>
                    </div>

                    <!-- Score Breakdown -->
                    <div class="grid md:grid-cols-3 gap-6 mb-6">
                        <div class="bg-white rounded-xl shadow-lg p-6 text-center hover-scale">
                            <div class="text-5xl mb-3">ğŸ“ˆ</div>
                            <p class="text-sm text-gray-600 mb-2 font-medium">Environmental Objective Score</p>
                            <p class="text-4xl font-black ${r.eoScore >= 80 ? 'text-green-600' : r.eoScore >= 60 ? 'text-yellow-600' : 'text-red-600'}">
                                ${r.eoScore}/100
                            </p>
                            <p class="text-xs text-gray-500 mt-2">${r.selectedEO}</p>
                        </div>
                        <div class="bg-white rounded-xl shadow-lg p-6 text-center hover-scale">
                            <div class="text-5xl mb-3">${r.dnshPass ? 'âœ…' : 'âŒ'}</div>
                            <p class="text-sm text-gray-600 mb-2 font-medium">DNSH Check</p>
                            <p class="text-4xl font-black ${r.dnshPass ? 'text-green-600' : 'text-red-600'}">
                                ${r.dnshPass ? 'PASS' : 'FAIL'}
                            </p>
                            <p class="text-xs text-gray-500 mt-2">Do No Significant Harm</p>
                        </div>
                        <div class="bg-white rounded-xl shadow-lg p-6 text-center hover-scale">
                            <div class="text-5xl mb-3">${r.socialPass ? 'âœ…' : 'âŒ'}</div>
                            <p class="text-sm text-gray-600 mb-2 font-medium">Social Aspects</p>
                            <p class="text-4xl font-black ${r.socialPass ? 'text-green-600' : 'text-red-600'}">
                                ${r.socialPass ? 'PASS' : 'FAIL'}
                            </p>
                            <p class="text-xs text-gray-500 mt-2">Safety, Wages, Equality</p>
                        </div>
                    </div>

                    <!-- Recommendations -->
                    <div class="bg-white rounded-xl shadow-lg p-8 mb-6">
                        <h3 class="text-2xl font-bold mb-6 text-gray-800 flex items-center">
                            <span class="text-3xl mr-3">ğŸ’¡</span> Recommendations & Next Steps
                        </h3>
                        <div class="space-y-4">
                            ${r.recommendations.map(rec => `
                                <div class="flex items-start bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition">
                                    <span class="text-2xl mr-3 flex-shrink-0">
                                        ${rec.includes('ğŸ‰') || rec.includes('âœ“') || rec.includes('Congratulations') ? 'ğŸ‰' : 
                                          rec.includes('âš ï¸') || rec.includes('Focus') ? 'ğŸ¯' : 
                                          rec.includes('âŒ') || rec.includes('does not') ? 'ğŸ“Œ' : 'ğŸ’¡'}
                                    </span>
                                    <p class="text-gray-700 leading-relaxed">${rec.replace(/[ğŸ‰ğŸ’°ğŸ“ˆğŸ“„ğŸŒŸğŸ“ŠğŸ¯âš ï¸ğŸ‘¥ğŸ’¼ğŸ“…ğŸ¤ğŸ“ŒğŸ”§ğŸ‘¨â€ğŸ’¼ğŸ’¡ğŸ“‹ğŸ“šğŸŒ±]/g, '')}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- What This Means -->
                    <div class="bg-gradient-to-r from-blue-50 to-cyan-50 rounded-xl shadow-lg p-8 mb-6 border-2 border-blue-200">
                        <h3 class="text-xl font-bold mb-4 text-gray-800 flex items-center">
                            <span class="text-3xl mr-3">â„¹ï¸</span> What This Classification Means
                        </h3>
                        ${r.classification === 'GREEN' ? `
                            <div class="space-y-3 text-gray-700">
                                <p>âœ… <strong>Eligible for green loans</strong> with preferential interest rates (typically 1-2% lower)</p>
                                <p>âœ… <strong>Priority access</strong> to sustainable financing programs from Indonesian banks</p>
                                <p>âœ… <strong>Enhanced reputation</strong> with investors, customers, and partners</p>
                                <p>âœ… <strong>Compliance ready</strong> for upcoming sustainability disclosure requirements</p>
                                <p>âœ… <strong>Competitive advantage</strong> in tenders requiring sustainability credentials</p>
                            </div>
                        ` : r.classification === 'TRANSITION' ? `
                            <div class="space-y-3 text-gray-700">
                                <p>âš ï¸ <strong>Partial eligibility</strong> for some sustainable financing programs</p>
                                <p>ğŸ“Š <strong>Improvement pathway</strong> identified - work on specific areas to reach GREEN status</p>
                                <p>ğŸ’¼ <strong>Access to transition finance</strong> to support your sustainability journey</p>
                                <p>ğŸ¯ <strong>Target timeline:</strong> 12-24 months to achieve GREEN classification with focused efforts</p>
                                <p>ğŸ¤ <strong>Support available:</strong> Many banks offer consulting to help transition businesses improve</p>
                            </div>
                        ` : `
                            <div class="space-y-3 text-gray-700">
                                <p>ğŸ“Œ <strong>Not yet eligible</strong> for green financing programs</p>
                                <p>ğŸ”§ <strong>Immediate action needed</strong> to meet basic sustainability standards</p>
                                <p>ğŸ‘¨â€ğŸ’¼ <strong>Expert guidance recommended</strong> - consider hiring a sustainability consultant</p>
                                <p>ğŸ“š <strong>Training resources:</strong> Free sustainability courses available from OJK and industry associations</p>
                                <p>ğŸŒ± <strong>Start small:</strong> Even basic improvements can move you toward TRANSITION status</p>
                                <p>ğŸ’ª <strong>Remember:</strong> Every sustainable business started where you are - the journey begins with awareness</p>
                            </div>
                        `}
                    </div>

                    <!-- Actions -->
                    <div class="grid md:grid-cols-2 gap-4 mb-6">
                        <button onclick="generateReport()" 
                            class="bg-blue-600 text-white py-4 px-6 rounded-xl font-bold text-lg shadow-lg hover:bg-blue-700 hover:shadow-xl transform hover:-translate-y-1 transition duration-200 flex items-center justify-center">
                            <span class="text-2xl mr-2">ğŸ“¥</span> Download Full Report
                        </button>
                        <button onclick="resetAssessment()" 
                            class="bg-gray-600 text-white py-4 px-6 rounded-xl font-bold text-lg shadow-lg hover:bg-gray-700 hover:shadow-xl transform hover:-translate-y-1 transition duration-200 flex items-center justify-center">
                            <span class="text-2xl mr-2">ğŸ”„</span> New Assessment
                        </button>
                    </div>

                    <!-- Share Section -->
                    <div class="bg-white rounded-xl shadow-lg p-8 text-center">
                        <h3 class="text-xl font-bold mb-3 text-gray-800">ğŸ“¢ Share Your Achievement</h3>
                        <p class="text-gray-600 mb-4">Help other SMEs discover sustainable financing opportunities</p>
                        <div class="flex flex-wrap justify-center gap-3">
                            <button onclick="alert('Share functionality would integrate with social media APIs')" 
                                class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition">
                                Share on LinkedIn
                            </button>
                            <button onclick="alert('Share functionality would integrate with social media APIs')" 
                                class="bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition">
                                Share on WhatsApp
                            </button>
                            <button onclick="navigator.clipboard.writeText(window.location.href); alert('Link copied to clipboard!')" 
                                class="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition">
                                Copy Link
                            </button>
                        </div>
                    </div>

                    <!-- Footer Info -->
                    <div class="mt-8 text-center text-sm text-gray-500">
                        <p class="mb-2">Disclaimer: This assessment is an academic purposes demo version based on the <strong>Indonesian Taxonomy for Sustainable Finance (TKBI)</strong></p>
                        <p>Framework developed by Otoritas Jasa Keuangan (OJK) â€¢ Sector Agnostic Decision Tree (SDT) Methodology</p>
                        <p class="mt-4 text-xs">For official green financing applications, this report should be submitted alongside required documentation to Indonesian financial institutions.</p>
                    </div>
                </div>
            `;
        }

        // ==================== EVENT HANDLERS ====================
        function startAssessment() {
            state.smeData.companyName = document.getElementById('companyName').value.trim();
            state.smeData.industry = document.getElementById('industry').value;
            state.smeData.employees = document.getElementById('employees').value;
            state.smeData.revenue = document.getElementById('revenue').value;

            if (!state.smeData.companyName || !state.smeData.industry || !state.smeData.employees || !state.smeData.revenue) {
                alert('âš ï¸ Please fill in all company information fields before starting the assessment.');
                return;
            }

            state.step = 'selectEO';
            render();
        }

        function selectEO(eo) {
            state.selectedEO = eo;
            state.step = 'eoQuestions';
            render();
        }

        function answerEOQuestion(questionId, answer) {
            state.eoAnswers[questionId] = answer;
            render();
        }

        function goToDNSH() {
            state.step = 'dnsh';
            window.scrollTo(0, 0);
            render();
        }

        function answerDNSH(questionId, answer) {
            state.dnshAnswers[questionId] = answer;
            render();
        }

        function goToSocial() {
            state.step = 'social';
            window.scrollTo(0, 0);
            render();
        }

        function answerSocial(questionId, answer) {
            state.socialAnswers[questionId] = answer;
            render();
        }

        function resetAssessment() {
            if (confirm('ğŸ”„ Are you sure you want to start a new assessment? Current progress will be lost.')) {
                state = {
                    step: 'intro',
                    smeData: { companyName: '', industry: '', employees: '', revenue: '' },
                    selectedEO: '',
                    eoAnswers: {},
                    dnshAnswers: {},
                    socialAnswers: {},
                    results: null
                };
                window.scrollTo(0, 0);
                render();
            }
        }

        // ==================== MAIN RENDER ====================
        function render() {
            const app = document.getElementById('app');
            let content = '';

            switch(state.step) {
                case 'intro':
                    content = renderIntro();
                    break;
                case 'selectEO':
                    content = renderEOSelection();
                    break;
                case 'eoQuestions':
                    content = renderEOQuestions();
                    break;
                case 'dnsh':
                    content = renderDNSH();
                    break;
                case 'social':
                    content = renderSocial();
                    break;
                case 'results':
                    content = renderResults();
                    break;
            }

            app.innerHTML = content;
            window.scrollTo(0, 0);
        }

        // ==================== INITIALIZE ====================
        render();
    </script>
</body>
</html>
